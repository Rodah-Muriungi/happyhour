{"ast":null,"code":"var _s = $RefreshSig$();\n// src/useOnlineStatus.js - Custom hook for online status\nimport { useEffect } from \"react\";\nimport { doc, updateDoc, onSnapshot, serverTimestamp } from \"firebase/firestore\";\nimport { db } from \"./firebase\";\nexport const useOnlineStatus = userId => {\n  _s();\n  useEffect(() => {\n    if (!userId) return;\n\n    // Set user as online when component mounts\n    const userRef = doc(db, \"users\", userId);\n    const updateOnlineStatus = async () => {\n      try {\n        await updateDoc(userRef, {\n          isOnline: true,\n          lastSeen: serverTimestamp(),\n          lastActive: new Date().toISOString()\n        });\n      } catch (error) {\n        console.error(\"Error updating online status:\", error);\n      }\n    };\n    updateOnlineStatus();\n\n    // Set up real-time listener for this user\n    const unsubscribe = onSnapshot(userRef, doc => {\n      // Keep connection alive\n    });\n\n    // Set user as offline when component unmounts\n    const handleBeforeUnload = async () => {\n      try {\n        await updateDoc(userRef, {\n          isOnline: false,\n          lastSeen: serverTimestamp()\n        });\n      } catch (error) {\n        console.error(\"Error setting offline status:\", error);\n      }\n    };\n\n    // Cleanup on unmount\n    return () => {\n      handleBeforeUnload();\n      unsubscribe();\n    };\n  }, [userId]);\n};\n\n// Function to manually set offline status\n_s(useOnlineStatus, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\nexport const setOffline = async userId => {\n  if (!userId) return;\n  try {\n    const userRef = doc(db, \"users\", userId);\n    await updateDoc(userRef, {\n      isOnline: false,\n      lastSeen: serverTimestamp()\n    });\n  } catch (error) {\n    console.error(\"Error setting offline:\", error);\n  }\n};","map":{"version":3,"names":["useEffect","doc","updateDoc","onSnapshot","serverTimestamp","db","useOnlineStatus","userId","_s","userRef","updateOnlineStatus","isOnline","lastSeen","lastActive","Date","toISOString","error","console","unsubscribe","handleBeforeUnload","setOffline"],"sources":["C:/Users/Admin/Desktop/my python projects/happyhour/src/useOnlineStatus.js"],"sourcesContent":["// src/useOnlineStatus.js - Custom hook for online status\r\nimport { useEffect } from \"react\";\r\nimport { doc, updateDoc, onSnapshot, serverTimestamp } from \"firebase/firestore\";\r\nimport { db } from \"./firebase\";\r\n\r\nexport const useOnlineStatus = (userId) => {\r\n  useEffect(() => {\r\n    if (!userId) return;\r\n\r\n    // Set user as online when component mounts\r\n    const userRef = doc(db, \"users\", userId);\r\n    \r\n    const updateOnlineStatus = async () => {\r\n      try {\r\n        await updateDoc(userRef, {\r\n          isOnline: true,\r\n          lastSeen: serverTimestamp(),\r\n          lastActive: new Date().toISOString()\r\n        });\r\n      } catch (error) {\r\n        console.error(\"Error updating online status:\", error);\r\n      }\r\n    };\r\n\r\n    updateOnlineStatus();\r\n\r\n    // Set up real-time listener for this user\r\n    const unsubscribe = onSnapshot(userRef, (doc) => {\r\n      // Keep connection alive\r\n    });\r\n\r\n    // Set user as offline when component unmounts\r\n    const handleBeforeUnload = async () => {\r\n      try {\r\n        await updateDoc(userRef, {\r\n          isOnline: false,\r\n          lastSeen: serverTimestamp()\r\n        });\r\n      } catch (error) {\r\n        console.error(\"Error setting offline status:\", error);\r\n      }\r\n    };\r\n\r\n    // Cleanup on unmount\r\n    return () => {\r\n      handleBeforeUnload();\r\n      unsubscribe();\r\n    };\r\n  }, [userId]);\r\n};\r\n\r\n// Function to manually set offline status\r\nexport const setOffline = async (userId) => {\r\n  if (!userId) return;\r\n  \r\n  try {\r\n    const userRef = doc(db, \"users\", userId);\r\n    await updateDoc(userRef, {\r\n      isOnline: false,\r\n      lastSeen: serverTimestamp()\r\n    });\r\n  } catch (error) {\r\n    console.error(\"Error setting offline:\", error);\r\n  }\r\n};"],"mappings":";AAAA;AACA,SAASA,SAAS,QAAQ,OAAO;AACjC,SAASC,GAAG,EAAEC,SAAS,EAAEC,UAAU,EAAEC,eAAe,QAAQ,oBAAoB;AAChF,SAASC,EAAE,QAAQ,YAAY;AAE/B,OAAO,MAAMC,eAAe,GAAIC,MAAM,IAAK;EAAAC,EAAA;EACzCR,SAAS,CAAC,MAAM;IACd,IAAI,CAACO,MAAM,EAAE;;IAEb;IACA,MAAME,OAAO,GAAGR,GAAG,CAACI,EAAE,EAAE,OAAO,EAAEE,MAAM,CAAC;IAExC,MAAMG,kBAAkB,GAAG,MAAAA,CAAA,KAAY;MACrC,IAAI;QACF,MAAMR,SAAS,CAACO,OAAO,EAAE;UACvBE,QAAQ,EAAE,IAAI;UACdC,QAAQ,EAAER,eAAe,CAAC,CAAC;UAC3BS,UAAU,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;QACrC,CAAC,CAAC;MACJ,CAAC,CAAC,OAAOC,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,+BAA+B,EAAEA,KAAK,CAAC;MACvD;IACF,CAAC;IAEDN,kBAAkB,CAAC,CAAC;;IAEpB;IACA,MAAMQ,WAAW,GAAGf,UAAU,CAACM,OAAO,EAAGR,GAAG,IAAK;MAC/C;IAAA,CACD,CAAC;;IAEF;IACA,MAAMkB,kBAAkB,GAAG,MAAAA,CAAA,KAAY;MACrC,IAAI;QACF,MAAMjB,SAAS,CAACO,OAAO,EAAE;UACvBE,QAAQ,EAAE,KAAK;UACfC,QAAQ,EAAER,eAAe,CAAC;QAC5B,CAAC,CAAC;MACJ,CAAC,CAAC,OAAOY,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,+BAA+B,EAAEA,KAAK,CAAC;MACvD;IACF,CAAC;;IAED;IACA,OAAO,MAAM;MACXG,kBAAkB,CAAC,CAAC;MACpBD,WAAW,CAAC,CAAC;IACf,CAAC;EACH,CAAC,EAAE,CAACX,MAAM,CAAC,CAAC;AACd,CAAC;;AAED;AAAAC,EAAA,CA9CaF,eAAe;AA+C5B,OAAO,MAAMc,UAAU,GAAG,MAAOb,MAAM,IAAK;EAC1C,IAAI,CAACA,MAAM,EAAE;EAEb,IAAI;IACF,MAAME,OAAO,GAAGR,GAAG,CAACI,EAAE,EAAE,OAAO,EAAEE,MAAM,CAAC;IACxC,MAAML,SAAS,CAACO,OAAO,EAAE;MACvBE,QAAQ,EAAE,KAAK;MACfC,QAAQ,EAAER,eAAe,CAAC;IAC5B,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOY,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;EAChD;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}